<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
        <title>Cholera Outbreak of 1854</title>
        <script src="https://d3js.org/d3.v7.min.js"></script>
        <link rel="stylesheet" href="style.css">
	</head>
	<body>
		<div class = "header">Cholera Outbreak of 1854</div>
        <div class="grid">
            <div class="g s1">
				<svg width="600" height="600"></svg>
			</div>
            <div class="g s2"></div>
            <div class="g s3"></div>
            <div class="g s4"></div>
       </div>
		
		

		<script>

			var MAP_SIZE = 600;

			d3.json("data/streets.json").then(function(data) {
				const svg = d3.select("svg");

				// Create zoom behavior and set the minimum and maximum zoom levels
				let zoom = d3.zoom()
					.scaleExtent([1, 8])
					.on("zoom", zoomed);

				// Apply the zoom behavior to the SVG element
				d3.select('svg').call(zoom);

				var xScale = d3.scaleLinear();
				var yScale = d3.scaleLinear();

				xScale.domain([3,20]).range([0, MAP_SIZE]);
				yScale.domain([20,3]).range([0, MAP_SIZE]);

				const line = d3.line()
				.x(d => xScale(d.x))
				.y(d => yScale(d.y));

				const lineGroups = svg.selectAll("g")
				.data(data)
				.enter()
				.append("g");

				lineGroups.append("path")
				.attr("d", d => line(d))
				.attr("stroke", "black")
				.attr("stroke-width", 2)
				.attr("fill", "none");

				drawpumps(xScale,yScale);
      		});

			function drawpumps(xScale,yScale) {
				d3.csv("data/pumps.csv").then(function(pumps) {
					console.log(pumps)

					var dots = d3.select('svg').append('g');

					dots.selectAll('circle')
						.data(pumps)
						.enter().append('circle')
						.style('fill', 'black')
						.attr('r', '5px')
						.attr('cx', function(d) { return xScale(d.x); })
						.attr('cy', function(d) { return yScale(d.y); });
							
				})
			};

			// Apply the zoom transformation to the SVG elements
			function zoomed(m) {
				d3.select("svg").attr("transform", m.transform);
			};
		</script>
	</body>
</html>