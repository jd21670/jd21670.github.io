<head>
    <meta charset="utf-8">
    <title>Cholera Outbreak of 1854</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://vega.github.io/datalib/datalib.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<script>
    var data = [
      {month: new Date(2018, 1, 1), apples: 400, bananas: 200, cherries: 96, dates: 40},
      {month: new Date(2018, 2, 1), apples: 160, bananas: 150, cherries: 96, dates: 40},
      {month: new Date(2018, 3, 1), apples:  64, bananas:  96, cherries: 64, dates: 40},
      {month: new Date(2018, 4, 1), apples:  32, bananas:  48, cherries: 64, dates: 40}
    ];
    
    var stack = d3.stack()
      .keys(["apples", "bananas", "cherries", "dates"]);
      
    var stackedSeries = stack(data);
    
    var xScale = d3.scaleTime().domain([data[0].month, data[3].month]).range([50,235]);
    var yScale = d3.scaleLinear().domain([0, 650]).range([275,25]);
    var colorScale = d3.scaleOrdinal()
      .domain(["apples", "bananas", "oranges", "cherries", "grapes", "dates"])
      .range(["red", "yellow", "orange", "pink", "purple", "brown"]);
            

            
    // Create a g element for each series
    var sel = d3.select("#demo2")
      .select('g')
      .selectAll('g.series')
      .data(stackedSeries)
      .join('g')
      .classed('series', true)
      .style('fill', (d) => colorScale(d.key));
    
    // For each series create a rect element for each month
    sel.selectAll('rect')
      .data((d) => d)
      .join('rect')
      .attr('width', 40)
      .attr('y', (d) => yScale(d[1]))
      .attr('x', (d) => xScale(d.data.month) - 20)
      .attr('height', (d) => yScale(d[0]) -  yScale(d[1]));
    </script>
    
    <svg id="demo2" width="300" height="300"></svg>>